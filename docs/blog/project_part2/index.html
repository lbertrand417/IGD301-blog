<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.svg">

  <title>
    Project Part 2 - IGD301 - Blog
  </title>
  <meta name="description" content="Locomotion technique: Teleportation ball" /><meta name="generator" content="Hugo 0.91.1" /><link
    rel="stylesheet"
    href="https://lbertrand417.github.io/IGD301-blog/css/styles.min.0329d07cf5e07cd52141990c36f0feb8332eddb71a5c450ee2d65d94eedccf7d.css"
    integrity="sha256-AynQfPXgfNUhQZkMNvD+uDMu3bcaXEUO4tZdlO7cz30="
  />
  
  

  <meta property="og:title" content="Project Part 2" />
<meta property="og:description" content="Locomotion technique: Teleportation ball" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lbertrand417.github.io/IGD301-blog/blog/project_part2/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2022-02-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-04T00:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Project Part 2"/>
<meta name="twitter:description" content="Locomotion technique: Teleportation ball"/>

  <meta itemprop="name" content="Project Part 2">
<meta itemprop="description" content="Locomotion technique: Teleportation ball"><meta itemprop="datePublished" content="2022-02-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-02-04T00:00:00+00:00" />
<meta itemprop="wordCount" content="1042">
<meta itemprop="keywords" content="Locomotion,VR,ball,teleportation," />
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-around md:justify-between gap-4 flex-wrap p-6 mx-auto">
  <a href="https://lbertrand417.github.io/IGD301-blog/" class="capitalize font-extrabold text-2xl">
    IGD301 - Blog
  </a>
  <ul class="flex items-center gap-4 lg:gap-6">

    
    <li><a href="/IGD301-blog/blog">Blog</a></li>
    
    <li><a href="/IGD301-blog/page/about/">About</a></li>
    
    <li><a href="/IGD301-blog/tags">Tags</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
    <li class="grid place-items-center">
      <span class="toggle-dark-mode inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="12" cy="12" r="3" />
          <line x1="12" y1="5" x2="12" y2="5.01" />
          <line x1="17" y1="7" x2="17" y2="7.01" />
          <line x1="19" y1="12" x2="19" y2="12.01" />
          <line x1="17" y1="17" x2="17" y2="17.01" />
          <line x1="12" y1="19" x2="12" y2="19.01" />
          <line x1="7" y1="17" x2="7" y2="17.01" />
          <line x1="5" y1="12" x2="5" y2="12.01" />
          <line x1="7" y1="7" x2="7" y2="7.01" />
        </svg>
      </span>
    </li>
    
  </ul>
</header><main class="flex-1">
  
  

  
  <div class="relative max-w-5xl mx-auto px-4">
    <img src="https://l3apq3bncl82o596k2d1ydn1-wpengine.netdna-ssl.com/wp-content/uploads/2019/06/KATloco_5.jpg" class="rounded-lg shadow-sm w-full object-contain" />
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    February 4, 2022
  


    </div>
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Project Part 2</h1>
    <h5 class="text-sm flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Posted on 
  
    February 4, 2022
  


      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      5&nbsp;minutes
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      1042&nbsp;words
      
    </h5>

    <p>It&rsquo;s time to get back to the project. As described in the previous post there are two major issues to address:</p>
<ul>
<li>The ball sometimes crosses the ground when it has a collider</li>
<li>It is difficult to start the game. In fact, the user does not collide with the collider of the banner because of teleportation.</li>
</ul>
<p>Today I will focus on the balls and leave the problem of starting the game for another time. After some tests and research,
I noticed that the problem of the ball crossing the ground was linked to the collider type we use, the mesh collider. Indeed, the mesh collider has no thickness
and the movement of the ball must be too fast. Therefore, it never touches the collider. The solution I found is to select isConvex in the collider parameters.
This solved the problem for most tiles. However, the problem with this method is that as the sidewalk is slightly higher than the road, the collider was also
higher than the road and so it looked like the ball was floating. For these tiles, I replaced the mesh collider by a box collider and adjusted the height to the road.
Now, the ball goes slightly into the ground on the sidewalks but lands correctly on the road. It could be further improved by combining 3 box colliders
(1 for each sidewalk and 1 for the road) but as the user is not really supposed to go out of the road I considered that it was not necessary.</p>
<p>Now that this problem is solved, it&rsquo;s time to create new balls. The idea is to change the ball using the thumbstick of the controller in which the ball is located
(here the right hand). To do this, I created in the MySelect.cs (where the ball change will be managed) an array &ldquo;balls[]&rdquo; containing the different possible
balls as well as an index &ldquo;currentBall&rdquo; indicating the ball held in hand. I also added, in this same script, a function allowing to change the ball. For this part,
I met several problems:</p>
<ul>
<li>Even if the MySelect.cs script is attached to the right controller, I had to use the thumbstick of the left controller to change the ball. I think the mistake was that
I wrote</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">Vector2 primaryAxis <span style="color:#ff79c6">=</span> OVRInput.Get(OVRInput.Axis2D.PrimaryThumbstick);
</code></pre></div><p>instead of</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">Vector2 primaryAxis <span style="color:#ff79c6">=</span> OVRInput.Get(OVRInput.Axis2D.PrimaryThumbstick, controller);
</code></pre></div><ul>
<li>The ball change to the right worked but not to the left. The reason was that I was changing the index with this command</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">currentBall <span style="color:#ff79c6">=</span> (currentBall <span style="color:#ff79c6">+</span> increment) <span style="color:#ff79c6">%</span> balls.Length;
</code></pre></div><p>but I was actually getting negative indices.
So instead of calling balls[currentBall] I replaced it with balls[Mathf.Abs(currentBall)].</p>
<ul>
<li>The change was happening way too fast. Indeed, my code was in the Update() function and so the ball was changing 3 to 4 times in the interval when the thumbstick
was moved. To solve this problem I used a coroutine, in order to wait a certain time before continuing the Update(). This gives the user time to let go of the
thumbstick before the function restarts.</li>
</ul>
<p>So the code to change the ball looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#ff79c6">if</span> (primaryAxis.x <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0.95f</span> <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#ff79c6">!</span>isThrowing <span style="color:#ff79c6">&amp;&amp;</span> changeBall)
{
	StartCoroutine(ChangeBall(<span style="color:#bd93f9">1</span>));
                        
}

<span style="color:#ff79c6">if</span> (primaryAxis.x <span style="color:#ff79c6">&lt;</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">0.95f</span> <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#ff79c6">!</span>isThrowing <span style="color:#ff79c6">&amp;&amp;</span> changeBall)
{
	StartCoroutine(ChangeBall(<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>));
}

<span style="color:#ff79c6">private</span> IEnumerator <span style="color:#50fa7b">ChangeBall</span>(<span style="color:#8be9fd">int</span> increment)
{
	changeBall <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">false</span>;
	balls[Mathf.Abs(currentBall)].SetActive(<span style="color:#8be9fd;font-style:italic">false</span>);
	currentBall <span style="color:#ff79c6">=</span> (currentBall <span style="color:#ff79c6">+</span> increment) <span style="color:#ff79c6">%</span> balls.Length;
	balls[Mathf.Abs(currentBall)].SetActive(<span style="color:#8be9fd;font-style:italic">true</span>);
	locomotion.currentBall <span style="color:#ff79c6">=</span> balls[Mathf.Abs(currentBall)];
	AttachBall();
	yield <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> WaitForSeconds(<span style="color:#bd93f9">0.5f</span>);
	changeBall <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">true</span>;
}
</code></pre></div><p>Note that I also changed the asset of the petanque ball to make it more realistic. For this I took a file of a petanque ball for 3D impression that I converted
into a .obj file. Then I imported it in Unity and added a metallic material to make it looks like a real petanque ball.
However the anchor point of the object was different from the other balls so It wasn&rsquo;t attached properlyto the controller. My solution was to create an EmptyObject which
will contain my petanque prefab. Then, I moved the ball inside such that the anchor point of the empty object was in the middle of the ball.
This way the anchor point was back to its normal position.</p>
<p>Now that I have different balls, I also have to deal with the properties of the different balls. For this, I created a new Ball.cs script attached to each ball,
which stores their properties. A ball has a type (sticky, petanque, bouncy), a speedFactor and a velocityThreshold. The speed factor is used to determine
the speed of the ball when it is thrown. Indeed, I noticed that when throwing a ball with only the speed of the controller, the ball didn&rsquo;t go far enough
(even when decreasing the mass). The speed factor increases the speed that&rsquo;s why I replaced</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">rb.velocity <span style="color:#ff79c6">=</span> linearVelocity;
</code></pre></div><p>by</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">rb.velocity <span style="color:#ff79c6">=</span> balls[Mathf.Abs(currentBall)].GetComponent<span style="color:#ff79c6">&lt;</span>Ball<span style="color:#ff79c6">&gt;</span>().speedFactor <span style="color:#ff79c6">*</span> linearVelocity;
</code></pre></div><p>in the code to throw the ball. Beyond that,
the speedFactor is useful because each ball has different properties: we must be able to throw the bouncy ball very far unlike the petanque ball.</p>
<p>I talked about it in the previous post but the sticky ball should induce teleportation with the user upon collision with an object.
For that, in the Ball.cs script I added an OnCollideEnter() which checks that the ball is of type Sticky and which puts the speed at 0 in this case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#ff79c6">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">OnCollisionEnter</span>(Collision collision)
{
	Rigidbody rb <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.GetComponent<span style="color:#ff79c6">&lt;</span>Rigidbody<span style="color:#ff79c6">&gt;</span>();
	<span style="color:#ff79c6">if</span> (type <span style="color:#ff79c6">==</span> Type.sticky <span style="color:#ff79c6">||</span> (type <span style="color:#ff79c6">==</span> Type.bouncy <span style="color:#ff79c6">&amp;&amp;</span> rb.velocity.magnitude <span style="color:#ff79c6">&lt;</span> velocityThreshold))
	{
		rb.velocity <span style="color:#ff79c6">=</span> Vector3.zero;
	}
}
</code></pre></div><p>Finally, I noticed that there were still problems with my teleportation formula when we were on a hill. As I said last time, I put</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#ff79c6">this</span>.transform.position <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Vector3(currentBall.transform.position.x, currentBall.transform.position.y <span style="color:#ff79c6">+</span> <span style="color:#ff79c6">this</span>.transform.position.y, currentBall.transform.position.z);
</code></pre></div><p>But in reality the this.transform.position.y part, which is supposed to represent the user&rsquo;s height, increases as you go up, which is not right.
To fix this problem I created a constantHeight variable that takes the value of this.transform.position.y when the game starts and I use this one instead.
So I end up with</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#ff79c6">this</span>.transform.position <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Vector3(currentBall.transform.position.x, currentBall.transform.position.y <span style="color:#ff79c6">+</span> constantHeight, currentBall.transform.position.z);
</code></pre></div><p>These are all the changes made during this session. There is still the banner problem to solve and another problem I found during my tests today:
the ball sticks to the coins, and when it sticks the user teleports onto the coin.</p>

  </article><div class="bg-blue-100 dark:bg-gray-900">
  <div class="container px-6 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
    <div>
      <div class="text-2xl font-bold mb-2">Follow me</div>
      <p class="opacity-60">I&#39;m an engineer student in computer graphics</p>
    </div>
    <ul class="flex justify-center gap-4">
      
      
      <li>
        <a
          href="https://www.linkedin.com/in/lauriane-b-6b1064152/"
          target="_blank"
          rel="noopener"
          aria-label="LinkedIn"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      
      
      
      <li>
        <a
          href="https://github.com/lbertrand417"
          target="_blank"
          rel="noopener"
          aria-label="GitHub"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"
            />
          </svg>
        </a>
      </li>
      
      
      
      
      
      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2021 - Lauriane Bertrand · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12" />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="https://lbertrand417.github.io/IGD301-blog/js/scripts.min.js"></script>






<script>
  
  const darkmode = document.querySelector('.toggle-dark-mode');
  function toggleDarkMode() {
    if (document.documentElement.classList.contains('dark')) {
      document.documentElement.classList.remove('dark')
      localStorage.setItem('darkmode', 'light')
    } else {
      document.documentElement.classList.add('dark')
      localStorage.setItem('darkmode', 'dark')
    }
  }
  if (darkmode) {
    darkmode.addEventListener('click', toggleDarkMode);
  }

  const isDark = localStorage.getItem('darkmode');
  if (isDark && isDark === 'dark') {
    toggleDarkMode();
  }
</script>
</body>
</html>
